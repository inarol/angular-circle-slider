angular.module("ui.circleSlider",[]).directive("circleSlider",["$document","$timeout",function(e,n){return{restrict:"A",replace:!0,scope:{value:"=",max:"@",readonly:"@",onSliderStart:"=",onSliderChange:"=",onSliderEnd:"="},template:'<div class="circle" tabIndex="0">   <div class="text-wrap"><span class="text"></span></div>   <div class="handler"></div></div>',link:function(a,t,i){function l(e){var n=Math.round(m*Math.sin(e*g)),t=Math.round(m*-Math.cos(e*g)),i=e*a.max/360|0;S.css({left:n+m-x,top:t+m-x}),h.html(i+"&deg;")}function d(e){var t={x:e.pageX-b.x,y:e.pageY-b.y},i=Math.atan2(t.x-m,t.y-m),d=parseInt(-i/g+180);return n(function(){l(d),a.value=d||a.value},30),d||a.value}function u(){f&&a.onSliderEnd(a.value),e.unbind("mousemove",d),e.unbind("mouseup",u)}function o(e){switch(s&&a.onSliderStart(a.value),e.keyCode){case 40:case 39:a.$apply(function(){a.value=a.value++<a.max?a.value:0});break;case 38:case 37:a.$apply(function(){a.value=a.value--<0?a.max:a.value})}}function r(){f&&a.onSliderEnd(a.value)}var c=i.readonly,s=i.onSliderStart,v=i.onSliderChange,f=i.onSliderEnd,p=t,S=p.find(".handler"),h=p.find(".text"),m=p.width()/2,x=S.width()/2,y=p.offset(),b={x:y.left,y:y.top},g=Math.PI/180;a.$watch("value",function(e,n){l(a.value),e!==n&&v&&a.onSliderChange(e)}),p.bind("mousedown",function(n){if(!c){var t=d(n);s&&a.onSliderStart(t),e.bind("mousemove",d),e.bind("mouseup",u)}}),p.bind("keydown",o),p.bind("keyup",r)}}}]);