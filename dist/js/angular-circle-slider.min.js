angular.module("ui.circleSlider",[]).directive("circleSlider",["$document","$timeout",function(b,a){return{restrict:"A",replace:true,scope:{value:"=",max:"@"},template:'<div class="circle">'+'   <div class="text-wrap"><span class="text"></span></div>'+'   <div class="handler" tabIndex="0"></div>'+"</div>",link:function(q,i,l){var m=i;var j=m.find(".handler");var o=m.find(".text");var e=m.width()/2;var d=j.width()/2;var n=m.offset();var c={x:n.left,y:n.top};var p=Math.PI/180;q.$watch("value",function(s,r){f(q.value)});function f(s){var u=Math.round(e*Math.sin(s*p));var t=Math.round(e*-Math.cos(s*p));var r=(s*q.max/360)|0;j.css({left:u+e-d,top:t+e-d});o.html(r+"&deg;")}j.bind("mousedown",function(){b.bind("mousemove",k);b.bind("mouseup",h)});function k(t){var r={x:t.pageX-c.x,y:t.pageY-c.y};var u=Math.atan2(r.x-e,r.y-e);var s=-u/p+180;a(function(){f(s);q.value=parseInt(s)},30)}function h(){b.unbind("mousemove",k);b.unbind("mouseup",h)}j.bind("keydown",g);function g(r){switch(r.keyCode){case 40:case 39:q.$apply(function(){q.value=q.value++<q.max?q.value:0});break;case 38:case 37:q.$apply(function(){q.value=q.value--<0?q.max:q.value});break;default:break}}}}}]);